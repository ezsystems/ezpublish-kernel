parameters:
    # API
    ezpublish.api.repository.factory.class: eZ\Publish\Core\Base\Container\ApiLoader\RepositoryFactory
    ezpublish.api.inner_repository.class: eZ\Publish\Core\Repository\Repository
    ezpublish.field_type_collection.factory.class: eZ\Publish\Core\Base\Container\ApiLoader\FieldTypeCollectionFactory
    ezpublish.field_type_nameable_collection.factory.class: eZ\Publish\Core\Base\Container\ApiLoader\FieldTypeNameableCollectionFactory
    ezpublish.api.storage_engine.class: eZ\Publish\SPI\Persistence\Handler
    ezpublish.api.search_engine.class: eZ\Publish\SPI\Search\Handler

    # API services
    ezpublish.api.service.content.class: eZ\Publish\Core\Repository\ContentService
    ezpublish.api.service.content_type.class: eZ\Publish\Core\Repository\ContentTypeService
    ezpublish.api.service.field_type.class: eZ\Publish\Core\Repository\FieldTypeService
    ezpublish.api.service.role.class: eZ\Publish\Core\Repository\RoleService
    ezpublish.api.service.object_state.class: eZ\Publish\Core\Repository\ObjectStateService
    ezpublish.api.service.url_wildcard.class: eZ\Publish\Core\Repository\URLWildcardService
    ezpublish.api.service.url_alias.class: eZ\Publish\Core\Repository\URLAliasService
    ezpublish.api.service.user.class: eZ\Publish\Core\Repository\UserService
    ezpublish.api.service.search.class: eZ\Publish\Core\Repository\SearchService
    ezpublish.api.service.section.class: eZ\Publish\Core\Repository\SectionService
    ezpublish.api.service.trash.class: eZ\Publish\Core\Repository\TrashService
    ezpublish.api.service.location.class: eZ\Publish\Core\Repository\LocationService
    ezpublish.api.service.language.class: eZ\Publish\Core\Repository\LanguageService

    # Signal Slot API wrapper
    ezpublish.signalslot.repository.class: eZ\Publish\Core\SignalSlot\Repository
    ezpublish.signalslot.service.content.class: eZ\Publish\Core\SignalSlot\ContentService
    ezpublish.signalslot.service.content_type.class: eZ\Publish\Core\SignalSlot\ContentTypeService
    ezpublish.signalslot.service.field_type.class: eZ\Publish\Core\SignalSlot\FieldTypeService
    ezpublish.signalslot.service.role.class: eZ\Publish\Core\SignalSlot\RoleService
    ezpublish.signalslot.service.object_state.class: eZ\Publish\Core\SignalSlot\ObjectStateService
    ezpublish.signalslot.service.url_wildcard.class: eZ\Publish\Core\SignalSlot\URLWildcardService
    ezpublish.signalslot.service.url_alias.class: eZ\Publish\Core\SignalSlot\URLAliasService
    ezpublish.signalslot.service.user.class: eZ\Publish\Core\SignalSlot\UserService
    ezpublish.signalslot.service.search.class: eZ\Publish\Core\SignalSlot\SearchService
    ezpublish.signalslot.service.section.class: eZ\Publish\Core\SignalSlot\SectionService
    ezpublish.signalslot.service.trash.class: eZ\Publish\Core\SignalSlot\TrashService
    ezpublish.signalslot.service.location.class: eZ\Publish\Core\SignalSlot\LocationService
    ezpublish.signalslot.service.language.class: eZ\Publish\Core\SignalSlot\LanguageService
    ezpublish.signalslot.signal_dispatcher.class: eZ\Publish\Core\SignalSlot\SignalDispatcher\DefaultSignalDispatcher
    ezpublish.signalslot.signal_dispatcher_transaction_wrapper.class: eZ\Publish\Core\SignalSlot\SignalDispatcher\SignalDispatcherTransactionWrapper

    # SignalDispatcher factory
    ezpublish.signalslot.signal_dispatcher.factory.class: eZ\Publish\Core\Base\Container\ApiLoader\SignalSlot\SignalDispatcherFactory

services:
    # API
    ezpublish.api.repository:
        alias: ezpublish.signalslot.repository

    ezpublish.field_type_collection.factory:
        class: "%ezpublish.field_type_collection.factory.class%"
        calls:
            - [setContainer, ["@service_container"]]

    ezpublish.field_type_nameable_collection.factory:
        class: "%ezpublish.field_type_nameable_collection.factory.class%"
        calls:
            - [setContainer, ["@service_container"]]

    ezpublish.api.repository.factory:
        class: "%ezpublish.api.repository.factory.class%"
        arguments:
            - "%ezpublish.api.inner_repository.class%"
            - "@ezpublish.field_type_collection.factory"
            - "@ezpublish.field_type_nameable_collection.factory"
        calls:
            - [setContainer, ["@service_container"]]

    ezpublish.api.inner_repository:
        class: "%ezpublish.api.inner_repository.class%"
        factory: ["@ezpublish.api.repository.factory", buildRepository]
        arguments:
            - "@ezpublish.api.persistence_handler"
            - "@ezpublish.spi.search"
        lazy: true

    ezpublish.api.service.content:
        alias: ezpublish.signalslot.service.content

    ezpublish.api.service.content_type:
        alias: ezpublish.signalslot.service.content_type

    ezpublish.api.service.field_type:
        alias: ezpublish.signalslot.service.field_type

    ezpublish.api.service.role:
        alias: ezpublish.signalslot.service.role

    ezpublish.api.service.object_state:
        alias: ezpublish.signalslot.service.object_state

    ezpublish.api.service.url_wildcard:
        alias: ezpublish.signalslot.service.url_wildcard

    ezpublish.api.service.url_alias:
        alias: ezpublish.signalslot.service.url_alias

    ezpublish.api.service.user:
        alias: ezpublish.signalslot.service.user

    ezpublish.api.service.search:
        alias: ezpublish.signalslot.service.search

    ezpublish.api.service.section:
        alias: ezpublish.signalslot.service.section

    ezpublish.api.service.trash:
        alias: ezpublish.signalslot.service.trash

    ezpublish.api.service.location:
        alias: ezpublish.signalslot.service.location

    ezpublish.api.service.language:
        alias: ezpublish.signalslot.service.language

    # Inner API
    ezpublish.api.service.inner_content:
        class: %ezpublish.api.service.content.class%
        factory: ["@ezpublish.api.repository.factory", buildService]
        arguments: ["@ezpublish.api.inner_repository", Content]
        lazy: true

    ezpublish.api.service.inner_content_type:
        class: %ezpublish.api.service.content_type.class%
        factory: ["@ezpublish.api.repository.factory", buildService]
        arguments: ["@ezpublish.api.inner_repository", ContentType]
        lazy: true

    ezpublish.api.service.inner_field_type:
        class: %ezpublish.api.service.field_type.class%
        factory: ["@ezpublish.api.repository.factory", buildService]
        arguments: ["@ezpublish.api.inner_repository", FieldType]
        lazy: true

    ezpublish.api.service.inner_role:
        class: %ezpublish.api.service.role.class%
        factory: ["@ezpublish.api.repository.factory", buildService]
        arguments: ["@ezpublish.api.inner_repository", Role]
        lazy: true

    ezpublish.api.service.inner_object_state:
        class: %ezpublish.api.service.object_state.class%
        factory: ["@ezpublish.api.repository.factory", buildService]
        arguments: ["@ezpublish.api.inner_repository", ObjectState]
        lazy: true

    ezpublish.api.service.inner_url_wildcard:
        class: %ezpublish.api.service.url_wildcard.class%
        factory: ["@ezpublish.api.repository.factory", buildService]
        arguments: ["@ezpublish.api.inner_repository", URLWildcard]
        lazy: true

    ezpublish.api.service.inner_url_alias:
        class: %ezpublish.api.service.url_alias.class%
        factory: ["@ezpublish.api.repository.factory", buildService]
        arguments: ["@ezpublish.api.inner_repository", URLAlias]
        lazy: true

    ezpublish.api.service.inner_user:
        class: %ezpublish.api.service.user.class%
        factory: ["@ezpublish.api.repository.factory", buildService]
        arguments: ["@ezpublish.api.inner_repository", User]
        lazy: true

    ezpublish.api.service.inner_search:
        class: %ezpublish.api.service.search.class%
        factory: ["@ezpublish.api.repository.factory", buildService]
        arguments: ["@ezpublish.api.inner_repository", Search]
        lazy: true

    ezpublish.api.service.inner_section:
        class: %ezpublish.api.service.section.class%
        factory: ["@ezpublish.api.repository.factory", buildService]
        arguments: ["@ezpublish.api.inner_repository", Section]
        lazy: true

    ezpublish.api.service.inner_trash:
        class: %ezpublish.api.service.trash.class%
        factory: ["@ezpublish.api.repository.factory", buildService]
        arguments: ["@ezpublish.api.inner_repository", Trash]
        lazy: true

    ezpublish.api.service.inner_location:
        class: %ezpublish.api.service.location.class%
        factory: ["@ezpublish.api.repository.factory", buildService]
        arguments: ["@ezpublish.api.inner_repository", Location]
        lazy: true

    ezpublish.api.service.inner_language:
        class: %ezpublish.api.service.language.class%
        factory: ["@ezpublish.api.repository.factory", buildService]
        arguments: ["@ezpublish.api.inner_repository", ContentLanguage]
        lazy: true

    # Signal Slot API wrapper
    ezpublish.signalslot.repository:
        class: '%ezpublish.signalslot.repository.class%'
        arguments:
            - '@ezpublish.api.inner_repository'
            - '@ezpublish.signalslot.signal_dispatcher_transaction_wrapper'
            - '@ezpublish.signalslot.service.content'
            - '@ezpublish.signalslot.service.content_type'
            - '@ezpublish.signalslot.service.field_type'
            - '@ezpublish.signalslot.service.role'
            - '@ezpublish.signalslot.service.object_state'
            - '@ezpublish.signalslot.service.url_wildcard'
            - '@ezpublish.signalslot.service.url_alias'
            - '@ezpublish.signalslot.service.user'
            - '@ezpublish.signalslot.service.search'
            - '@ezpublish.signalslot.service.section'
            - '@ezpublish.signalslot.service.trash'
            - '@ezpublish.signalslot.service.location'
            - '@ezpublish.signalslot.service.language'

    ezpublish.signalslot.service.content:
        class: '%ezpublish.signalslot.service.content.class%'
        arguments:
            - '@ezpublish.api.service.inner_content'
            - '@ezpublish.signalslot.signal_dispatcher'

    ezpublish.signalslot.service.content_type:
        class: '%ezpublish.signalslot.service.content_type.class%'
        arguments:
            - '@ezpublish.api.service.inner_content_type'
            - '@ezpublish.signalslot.signal_dispatcher'

    ezpublish.signalslot.service.field_type:
        class: '%ezpublish.signalslot.service.field_type.class%'
        arguments:
            - '@ezpublish.api.service.inner_field_type'
            - '@ezpublish.signalslot.signal_dispatcher'

    ezpublish.signalslot.service.role:
        class: '%ezpublish.signalslot.service.role.class%'
        arguments:
            - '@ezpublish.api.service.inner_role'
            - '@ezpublish.signalslot.signal_dispatcher'

    ezpublish.signalslot.service.object_state:
        class: '%ezpublish.signalslot.service.object_state.class%'
        arguments:
            - '@ezpublish.api.service.inner_object_state'
            - '@ezpublish.signalslot.signal_dispatcher'

    ezpublish.signalslot.service.url_wildcard:
        class: '%ezpublish.signalslot.service.url_wildcard.class%'
        arguments:
            - '@ezpublish.api.service.inner_url_wildcard'
            - '@ezpublish.signalslot.signal_dispatcher'

    ezpublish.signalslot.service.url_alias:
        class: '%ezpublish.signalslot.service.url_alias.class%'
        arguments:
            - '@ezpublish.api.service.inner_url_alias'
            - '@ezpublish.signalslot.signal_dispatcher'

    ezpublish.signalslot.service.user:
        class: '%ezpublish.signalslot.service.user.class%'
        arguments:
            - '@ezpublish.api.service.inner_user'
            - '@ezpublish.signalslot.signal_dispatcher'

    ezpublish.signalslot.service.search:
        class: '%ezpublish.signalslot.service.search.class%'
        arguments:
            - '@ezpublish.api.service.inner_search'
            - '@ezpublish.signalslot.signal_dispatcher'

    ezpublish.signalslot.service.section:
        class: '%ezpublish.signalslot.service.section.class%'
        arguments:
            - '@ezpublish.api.service.inner_section'
            - '@ezpublish.signalslot.signal_dispatcher'

    ezpublish.signalslot.service.trash:
        class: '%ezpublish.signalslot.service.trash.class%'
        arguments:
            - '@ezpublish.api.service.inner_trash'
            - '@ezpublish.signalslot.signal_dispatcher'

    ezpublish.signalslot.service.location:
        class: '%ezpublish.signalslot.service.location.class%'
        arguments:
            - '@ezpublish.api.service.inner_location'
            - '@ezpublish.signalslot.signal_dispatcher'

    ezpublish.signalslot.service.language:
        class: '%ezpublish.signalslot.service.language.class%'
        arguments:
            - '@ezpublish.api.service.inner_language'
            - '@ezpublish.signalslot.signal_dispatcher'

    ezpublish.signalslot.signal_dispatcher_transaction_wrapper:
        class: "%ezpublish.signalslot.signal_dispatcher_transaction_wrapper.class%"
        arguments: ["@ezpublish.signalslot.signal_dispatcher"]

    ezpublish.signalslot.signal_dispatcher:
        class: "%ezpublish.signalslot.signal_dispatcher.class%"
        factory: ["@ezpublish.signalslot.signal_dispatcher.factory", buildSignalDispatcher]

    ezpublish.signalslot.signal_dispatcher.factory:
        class: "%ezpublish.signalslot.signal_dispatcher.factory.class%"
        arguments:
            - "%ezpublish.signalslot.signal_dispatcher.class%"
            - "legacy"
