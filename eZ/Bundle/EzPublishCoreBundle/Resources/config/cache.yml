services:
    # This overrides default cache pool in eZ/Publish/Core/settings/storage_engines/cache.yml
    ezpublish.cache_pool_inner:
        class: Symfony\Component\Cache\Adapter\TagAwareAdapterInterface
        lazy: true
        factory: ["@ezpublish.cache_pool.factory", getCachePool]
        arguments: ["@ezpublish.config.resolver"]

    ezpublish.cache_pool.factory:
        class: eZ\Bundle\EzPublishCoreBundle\ApiLoader\CacheFactory
        calls:
            - [setContainer, ["@service_container"]]

    # Cache warmer to rest config resolver on cache clear/warmup
    ezpublish.cache_warmer.config_resolver_cleanup:
        class: eZ\Bundle\EzPublishCoreBundle\Cache\Warmer\ConfigResolverCleanup
        calls:
            - [setContainer, ["@service_container"]]
        tags:
            - { name: kernel.cache_warmer }
